<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="description" content="AntEmpire Tower Defense - Defiende tu hormiguero" />
  <title>AntEmpire - Tower Defense ğŸœ</title>
  <link rel="stylesheet" href="/static/defense.css">
  <script src="/static/defense.js" defer></script>
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸœ</text></svg>">
</head>

<body>
  <!-- Barra superior: bienvenida y logout -->
  <div class="welcome-message">
    <span>ğŸœ Bienvenido, <strong id="usernameDisplay">hormiga</strong></span>
    <div class="controls">
      <button id="backBtn" class="back-btn" title="Volver al juego principal">ğŸ </button>
      <button id="helpBtn" class="help-btn" title="Ayuda">â“</button>
      <button id="logoutBtn" onclick="cerrarSesion()">Cerrar sesiÃ³n</button>
    </div>
  </div>
  <!-- js de bienvenida -->
  <script src="/static/welcome.js"></script>
  
  <!-- TÃ­tulo central y versiÃ³n -->
  <header>
    <h1>AntEmpire â€“ Tower Defense</h1>
    <div class="version">v2.0</div>
  </header>

  <!-- Layout principal: sidebar izquierda, contenido, panel de control -->
  <div class="dashboard">
    <!-- Panel lateral: Recursos y Torres -->
    <aside class="card">
      <h2>Recursos</h2>
      <div class="resources-container">
        <div class="resource" id="leaves">ğŸƒ Hojas: <span class="resource-value">50</span></div>
        <div class="resource" id="score">ğŸ† PuntuaciÃ³n: <span class="resource-value">0</span></div>
        <div class="resource" id="wave">ğŸŒŠ Oleada: <span class="resource-value">1</span>/10</div>
      </div>
      
      <h2>Torres Disponibles</h2>
      <div class="towers-container">
        <div class="tower-option" data-type="basic" draggable="true">
          <div class="tower-icon basic-tower">ğŸœ</div>
          <div class="tower-info">
            <div class="tower-name">Hormiga Soldado</div>
            <div class="tower-cost">Coste: 10 ğŸƒ</div>
          </div>
        </div>
        
        <div class="tower-option" data-type="shooter" draggable="true">
          <div class="tower-icon shooter-tower">ğŸ¹</div>
          <div class="tower-info">
            <div class="tower-name">Hormiga Arquera</div>
            <div class="tower-cost">Coste: 20 ğŸƒ</div>
          </div>
        </div>
        
        <div class="tower-option" data-type="bomber" draggable="true">
          <div class="tower-icon bomber-tower">ğŸ’£</div>
          <div class="tower-info">
            <div class="tower-name">Hormiga Bombardera</div>
            <div class="tower-cost">Coste: 30 ğŸƒ</div>
          </div>
        </div>
      </div>
      
      <div class="button-group">
        <button id="startWaveBtn" class="action-btn">Iniciar Oleada</button>
        <button id="speedBtn" class="action-btn">Velocidad: x1</button>
      </div>
    </aside>

    <!-- Zona principal: mapa de juego -->
    <main class="card">
      <div id="gameContainer">
        <canvas id="gameCanvas" width="600" height="400"></canvas>
        <div id="gameOverlay">
          <div id="gameMessage">Â¡PrepÃ¡rate para defender!</div>
          <button id="startGameBtn" class="action-btn">Comenzar Juego</button>
        </div>
        
        <!-- Panel de selecciÃ³n de torres para colocaciÃ³n rÃ¡pida -->
        <div id="towerSelectionPanel" class="tower-selection-panel">
          <div class="tower-select-btn" data-type="basic">
            <div class="tower-icon basic-tower">ğŸœ</div>
            <span>10 ğŸƒ</span>
          </div>
          <div class="tower-select-btn" data-type="shooter">
            <div class="tower-icon shooter-tower">ğŸ¹</div>
            <span>20 ğŸƒ</span>
          </div>
          <div class="tower-select-btn" data-type="bomber">
            <div class="tower-icon bomber-tower">ğŸ’£</div>
            <span>30 ğŸƒ</span>
          </div>
          <div class="tower-select-btn cancel-btn" id="cancelTowerSelection">
            <div class="tower-icon cancel-tower">âŒ</div>
            <span>Cancelar</span>
          </div>
        </div>
        
        <!-- Temporizador de oleada -->
        <div id="waveTimer" class="wave-timer">
          PrÃ³xima oleada: <span id="waveTimerValue">30</span>s
        </div>
      </div>
      
      <div class="game-controls">
        <div class="health-bar">
          <div>â¤ï¸ Salud del Hormiguero: <span id="healthValue">100</span>/100</div>
          <div class="health-bar-container">
            <div id="healthBarFill"></div>
          </div>
        </div>
      </div>
      
      <div class="log-container">
        <h3>Registro de Batalla <button id="clearLog" class="small-btn" title="Limpiar registro">ğŸ—‘ï¸</button></h3>
        <div class="log" id="battleLog"></div>
      </div>
      
      <!-- MenÃº contextual para torres -->
      <div id="towerContextMenu" class="tower-context-menu">
        <button id="upgradeTowerContextBtn" class="context-btn">Mejorar</button>
        <button id="sellTowerContextBtn" class="context-btn danger-btn">Vender</button>
        <button id="cancelContextBtn" class="context-btn">Cancelar</button>
      </div>
    </main>

    <!-- Panel derecho: InformaciÃ³n y Mejoras -->
    <aside class="card">
      <h2>InformaciÃ³n</h2>
      <div id="towerInfo">
        <p>Selecciona una torre para ver su informaciÃ³n</p>
      </div>
      
      <h2>Mejoras</h2>
      <div id="upgradePanel">
        <p>Selecciona una torre colocada para mejorarla</p>
      </div>
      
      <div class="button-group">
        <button id="sellTowerBtn" class="danger-btn" disabled>Vender Torre</button>
        <button id="upgradeTowerBtn" class="action-btn" disabled>Mejorar Torre</button>
        <button id="deselectTowerBtn" class="action-btn">Deseleccionar</button>
      </div>
    </aside>
  </div>
  
  <!-- Panel inferior para dispositivos mÃ³viles -->
  <div id="mobilePanel" class="mobile-panel">
    <div class="mobile-resource">ğŸƒ <span id="mobileLeaves">50</span></div>
    <div class="mobile-resource">â¤ï¸ <span id="mobileHealth">100</span></div>
    <div class="mobile-resource">ğŸŒŠ <span id="mobileWave">1/10</span></div>
  </div>
  
  <!-- Modal de ayuda -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h2>CÃ³mo jugar Tower Defense ğŸœ</h2>
      <div class="help-content">
        <h3>Objetivo</h3>
        <p>Defiende tu hormiguero de las oleadas de insectos enemigos construyendo torres defensivas.</p>
        
        <h3>Torres</h3>
        <ul>
          <li><strong>Hormiga Soldado (ğŸœ)</strong>: Ataque bÃ¡sico de corto alcance</li>
          <li><strong>Hormiga Arquera (ğŸ¹)</strong>: Ataque a distancia</li>
          <li><strong>Hormiga Bombardera (ğŸ’£)</strong>: Ataque de Ã¡rea</li>
        </ul>
        
        <h3>Enemigos</h3>
        <ul>
          <li><strong>Escarabajo</strong>: Enemigo bÃ¡sico</li>
          <li><strong>AraÃ±a</strong>: RÃ¡pido pero dÃ©bil</li>
          <li><strong>Hormiga Exploradora</strong>: Muy rÃ¡pida</li>
          <li><strong>Hormiga Soldado</strong>: Resistente</li>
          <li><strong>Avispa</strong>: Extremadamente rÃ¡pida</li>
          <li><strong>Escarabajo Gigante</strong>: Muy resistente</li>
          <li><strong>CiempiÃ©s</strong>: Jefe final</li>
        </ul>
        
        <h3>CÃ³mo jugar</h3>
        <ol>
          <li>Arrastra y suelta torres en el mapa</li>
          <li>Inicia la oleada cuando estÃ©s listo</li>
          <li>Mejora tus torres para aumentar su poder</li>
          <li>Sobrevive a las 10 oleadas para ganar</li>
        </ol>
        
        <h3>Recompensas</h3>
        <p>Al completar niveles ganarÃ¡s hojas que podrÃ¡s usar en el juego principal.</p>
        
        <h3>ImÃ¡genes</h3>
        <p>Este juego utiliza imÃ¡genes estÃ¡ticas para las torres.</p>
      </div>
    </div>
  </div>
  
  <script>
    // Funcionalidad del modal de ayuda
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('helpModal');
      const helpBtn = document.getElementById('helpBtn');
      const closeBtn = document.querySelector('.close-btn');
      const clearLogBtn = document.getElementById('clearLog');
      const backBtn = document.getElementById('backBtn');
      
      helpBtn.onclick = function() {
        modal.style.display = 'block';
      }
      
      closeBtn.onclick = function() {
        modal.style.display = 'none';
      }
      
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = 'none';
        }
      }
      
      if (clearLogBtn) {
        clearLogBtn.onclick = function() {
          const logElement = document.getElementById('battleLog');
          if (logElement) {
            logElement.innerHTML = '';
          }
        }
      }
      
      if (backBtn) {
        backBtn.onclick = function() {
          window.location.href = '/juego.html';
        }
      }
    });
  </script>
</body>
</html>