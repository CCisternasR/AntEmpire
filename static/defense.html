<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <meta name="description" content="AntEmpire Tower Defense - Defiende tu hormiguero" />
  <title>AntEmpire - Tower Defense ğŸœ</title>
  <link rel="stylesheet" href="/static/defense.css">
  <script src="/static/defense.js" defer></script>
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸœ</text></svg>">
</head>

<body>
  <!-- Barra superior: bienvenida y logout -->
  <div class="welcome-message">
    <span>ğŸœ Bienvenido, <strong id="usernameDisplay">hormiga</strong></span>
    <div class="controls">
      <button id="backBtn" class="back-btn" title="Volver al juego principal">ğŸ </button>
      <button id="helpBtn" class="help-btn" title="Ayuda">â“</button>
      <button id="logoutBtn" onclick="cerrarSesion()">Cerrar sesiÃ³n</button>
    </div>
  </div>
  <!-- js de bienvenida -->
  <script src="/static/welcome.js"></script>
  
  <!-- TÃ­tulo central y versiÃ³n -->
  <header>
    <h1>AntEmpire â€“ Tower Defense</h1>
    <div class="version">v2.0</div>
  </header>

  <!-- Layout principal: sidebar izquierda, contenido, panel de control -->
  <div class="dashboard">
    <!-- Panel lateral: Solo Recursos -->
    <aside class="card">
      <h2>Recursos</h2>
      <div class="resources-container">
        <div class="resource" id="leaves">ğŸƒ Hojas: <span class="resource-value">50</span></div>
        <div class="resource" id="score">ğŸ† PuntuaciÃ³n: <span class="resource-value">0</span></div>
        <div class="resource" id="wave">ğŸŒŠ Oleada: <span class="resource-value">1</span>/10</div>
      </div>
      
      <div class="button-group">
        <button id="startWaveBtn" class="action-btn">Iniciar Oleada</button>
        <button id="speedBtn" class="action-btn">Velocidad: x1</button>
        <button id="newMapBtn" class="action-btn">Nuevo Mapa</button>
      </div>
    </aside>

    <!-- Zona principal: mapa de juego -->
    <main class="card">
      <div id="gameContainer">
        <canvas id="gameCanvas" width="800" height="500"></canvas>
        <div id="gameOverlay">
          <div id="gameMessage">Â¡PrepÃ¡rate para defender!</div>
          <button id="startGameBtn" class="action-btn">Comenzar Juego</button>
        </div>
        

        
        <!-- Temporizador de oleada -->
        <div id="waveTimer" class="wave-timer">
          Oleada: <span id="waveTimerValue">3</span>s
        </div>
        
        <!-- Indicador de clima -->
        <div id="weatherIndicator" class="weather-indicator">
          <div class="weather-icon" id="weatherIcon">â˜€ï¸</div>
          <div class="weather-name" id="weatherName">Normal</div>
        </div>
        
        <!-- Indicador de recursos en el mapa -->
        <div id="mapResources" class="map-resources">
          <span>ğŸƒ <span id="mapLeaves">50</span></span>
          <span>â¤ï¸ <span id="mapHealth">100</span></span>
        </div>
        
        <!-- Controles fijos para mÃ³viles -->
        <div class="mobile-controls">
          <button id="mobileStartWaveBtn" class="mobile-btn">Oleada</button>
          <button id="mobileNewMapBtn" class="mobile-btn">Mapa</button>
          <div class="mobile-speed">x<span id="mobileSpeedValue">10</span></div>
        </div>
        
      </div>
      
      <!-- Barra de herramientas expandida -->
      <div id="toolbarPanel" class="toolbar-panel">
        <div class="toolbar-towers">
          <div class="towers-scroll-container">
            <div class="towers-scroll-content">
              <div class="toolbar-btn" data-type="basic" title="Hormiga Soldado - 10 hojas">
                <div class="toolbar-icon">ğŸœ</div>
                <span>10</span>
              </div>
              <div class="toolbar-btn" data-type="shooter" title="Hormiga Arquera - 20 hojas">
                <div class="toolbar-icon">ğŸ¹</div>
                <span>20</span>
              </div>
              <div class="toolbar-btn" data-type="bomber" title="Hormiga Bombardera - 30 hojas">
                <div class="toolbar-icon">ğŸ’£</div>
                <span>30</span>
              </div>
              <div class="toolbar-btn" data-type="poison" title="Hormiga Venenosa - 25 hojas">
                <div class="toolbar-icon">â˜ ï¸</div>
                <span>25</span>
              </div>
              <div class="toolbar-btn" data-type="fire" title="Hormiga de Fuego - 35 hojas">
                <div class="toolbar-icon">ğŸ”¥</div>
                <span>35</span>
              </div>
              <div class="toolbar-btn" data-type="ice" title="Hormiga de Hielo - 40 hojas">
                <div class="toolbar-icon">â„ï¸</div>
                <span>40</span>
              </div>
              <div class="toolbar-btn" data-type="carnivore" title="Hormiga CarnÃ­vora - 50 hojas">
                <div class="toolbar-icon">ğŸ¥©</div>
                <span>50</span>
              </div>
              <div class="toolbar-btn" data-type="queen" title="Hormiga Reina - 100 hojas">
                <div class="toolbar-icon">ğŸ‘‘</div>
                <span>100</span>
              </div>
              <div class="toolbar-btn cancel-btn" id="cancelTowerSelection" title="Cancelar selecciÃ³n">
                <div class="toolbar-icon">âŒ</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="toolbar-info" id="toolbarTowerInfo">
          <div class="toolbar-current-info">
            <div class="toolbar-info-title">Torre Actual</div>
            <div class="toolbar-info-content" id="currentTowerInfo">
              <p>Selecciona una torre</p>
            </div>
          </div>
          
          <div class="toolbar-upgrade-info">
            <div class="toolbar-info-title">PrÃ³ximo Nivel</div>
            <div class="toolbar-info-content" id="upgradeTowerInfo">
              <p>-</p>
            </div>
          </div>
          
          <div class="toolbar-actions">
            <button id="toolbarSellBtn" class="toolbar-action-btn danger" disabled>Vender</button>
            <button id="toolbarUpgradeBtn" class="toolbar-action-btn" disabled>Mejorar</button>
          </div>
        </div>
      </div>
      
      <div class="game-controls">
        <div class="health-bar">
          <div>â¤ï¸ Salud del Hormiguero: <span id="healthValue">100</span>/100</div>
          <div class="health-bar-container">
            <div id="healthBarFill"></div>
          </div>
        </div>
      </div>
      
      <div class="log-container">
        <h3>Registro de Batalla <button id="clearLog" class="small-btn" title="Limpiar registro">ğŸ—‘ï¸</button></h3>
        <div class="log" id="battleLog"></div>
      </div>
      
      <!-- MenÃº contextual para torres -->
      <div id="towerContextMenu" class="tower-context-menu">
        <button id="upgradeTowerContextBtn" class="context-btn">Mejorar</button>
        <button id="sellTowerContextBtn" class="context-btn danger-btn">Vender</button>
        <button id="cancelContextBtn" class="context-btn">Cancelar</button>
      </div>
    </main>

    <!-- Panel derecho: Solo TecnologÃ­as -->
    <aside class="card">
      <h2>TecnologÃ­as <span id="techPoints" class="tech-points">0 ğŸ”®</span></h2>
      <div id="techTree" class="tech-tree">
        <div class="tech-option">
          <span>DaÃ±o</span>
          <div class="tech-level" id="techDamage">â—‹â—‹â—‹â—‹â—‹</div>
          <button id="upgradeDamage" class="tech-btn" disabled>Mejorar (1 ğŸ”®)</button>
        </div>
        <div class="tech-option">
          <span>Alcance</span>
          <div class="tech-level" id="techRange">â—‹â—‹â—‹â—‹â—‹</div>
          <button id="upgradeRange" class="tech-btn" disabled>Mejorar (1 ğŸ”®)</button>
        </div>
        <div class="tech-option">
          <span>Velocidad</span>
          <div class="tech-level" id="techSpeed">â—‹â—‹â—‹â—‹â—‹</div>
          <button id="upgradeSpeed" class="tech-btn" disabled>Mejorar (1 ğŸ”®)</button>
        </div>
      </div>
      
      <!-- Elementos ocultos para compatibilidad -->
      <div id="towerInfo" style="display: none;"></div>
      <div id="upgradePanel" style="display: none;"></div>
      <div style="display: none;">
        <button id="sellTowerBtn" class="danger-btn" disabled>Vender Torre</button>
        <button id="upgradeTowerBtn" class="action-btn" disabled>Mejorar Torre</button>
        <button id="deselectTowerBtn" class="action-btn">Deseleccionar</button>
      </div>
    </aside>
  </div>
  

  
  <!-- Panel inferior para dispositivos mÃ³viles -->
  <div id="mobilePanel" class="mobile-panel">
    <div class="mobile-resource">ğŸƒ <span id="mobileLeaves">50</span></div>
    <div class="mobile-resource">â¤ï¸ <span id="mobileHealth">100</span></div>
    <div class="mobile-resource">ğŸŒŠ <span id="mobileWave">1/10</span></div>
  </div>
  
  <!-- Modal de ayuda -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h2>CÃ³mo jugar Tower Defense ğŸœ</h2>
      <div class="help-content">
        <h3>Objetivo</h3>
        <p>Defiende tu hormiguero de las oleadas de insectos enemigos construyendo torres defensivas.</p>
        
        <h3>Torres</h3>
        <ul>
          <li><strong>Hormiga Soldado (ğŸœ)</strong>: Ataque bÃ¡sico de corto alcance</li>
          <li><strong>Hormiga Arquera (ğŸ¹)</strong>: Ataque a distancia</li>
          <li><strong>Hormiga Bombardera (ğŸ’£)</strong>: Ataque de Ã¡rea</li>
          <li><strong>Hormiga Venenosa (â˜ ï¸)</strong>: Envenena a los enemigos causando daÃ±o continuo</li>
          <li><strong>Hormiga de Fuego (ğŸ”¥)</strong>: Quema a los enemigos causando daÃ±o por tiempo</li>
          <li><strong>Hormiga de Hielo (â„ï¸)</strong>: Ralentiza a los enemigos</li>
          <li><strong>Hormiga CarnÃ­vora (ğŸ¥©)</strong>: Alto daÃ±o con probabilidad de devorar enemigos</li>
          <li><strong>Hormiga Reina (ğŸ‘‘)</strong>: Genera hormigas soldado y mejora torres cercanas</li>
        </ul>
        
        <h3>Elementos</h3>
        <ul>
          <li><strong>Normal</strong>: Sin efectos especiales</li>
          <li><strong>Veneno</strong>: DaÃ±o continuo durante varios segundos</li>
          <li><strong>Fuego</strong>: DaÃ±o por quemadura</li>
          <li><strong>Hielo</strong>: Ralentiza a los enemigos</li>
        </ul>
        
        <h3>Enemigos</h3>
        <ul>
          <li><strong>Escarabajo</strong>: Enemigo bÃ¡sico</li>
          <li><strong>AraÃ±a</strong>: RÃ¡pido pero dÃ©bil</li>
          <li><strong>Hormiga Exploradora</strong>: Muy rÃ¡pida</li>
          <li><strong>Hormiga Soldado</strong>: Resistente</li>
          <li><strong>Avispa</strong>: Extremadamente rÃ¡pida</li>
          <li><strong>Escarabajo Gigante</strong>: Muy resistente</li>
          <li><strong>CiempiÃ©s</strong>: Jefe final</li>
        </ul>
        
        <h3>CÃ³mo jugar</h3>
        <ol>
          <li>Arrastra y suelta torres en el mapa</li>
          <li>Inicia la oleada cuando estÃ©s listo</li>
          <li>Mejora tus torres para aumentar su poder</li>
          <li>Sobrevive a las 10 oleadas para ganar</li>
        </ol>
        
        <h3>Recompensas</h3>
        <p>Al completar niveles ganarÃ¡s hojas que podrÃ¡s usar en el juego principal.</p>
        
        <h3>ImÃ¡genes</h3>
        <p>Este juego utiliza imÃ¡genes estÃ¡ticas para las torres.</p>
      </div>
    </div>
  </div>
  
  <script>
    // Funcionalidad del modal de ayuda
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('helpModal');
      const helpBtn = document.getElementById('helpBtn');
      const closeBtn = document.querySelector('.close-btn');
      const clearLogBtn = document.getElementById('clearLog');
      const backBtn = document.getElementById('backBtn');
      
      helpBtn.onclick = function() {
        modal.style.display = 'block';
      }
      
      closeBtn.onclick = function() {
        modal.style.display = 'none';
      }
      
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = 'none';
        }
      }
      
      if (clearLogBtn) {
        clearLogBtn.onclick = function() {
          const logElement = document.getElementById('battleLog');
          if (logElement) {
            logElement.innerHTML = '';
          }
        }
      }
      
      if (backBtn) {
        backBtn.onclick = function() {
          window.location.href = '/juego.html';
        }
      }
    });
  </script>
</body>
</html>