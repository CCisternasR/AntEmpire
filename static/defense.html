<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="AntEmpire Tower Defense - Defiende tu hormiguero" />
  <title>AntEmpire - Tower Defense 🐜</title>
  <link rel="stylesheet" href="/static/defense.css">
  <script src="/static/defense.js" defer></script>
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🐜</text></svg>">
</head>

<body>
  <!-- Barra superior: bienvenida y logout -->
  <div class="welcome-message">
    <span>🐜 Bienvenido, <strong id="usernameDisplay">hormiga</strong></span>
    <div class="controls">
      <button id="backBtn" class="back-btn" title="Volver al juego principal">🏠</button>
      <button id="helpBtn" class="help-btn" title="Ayuda">❓</button>
      <button id="logoutBtn" onclick="cerrarSesion()">Cerrar sesión</button>
    </div>
  </div>
  <!-- js de bienvenida -->
  <script src="/static/welcome.js"></script>
  
  <!-- Título central y versión -->
  <header>
    <h1>AntEmpire – Tower Defense</h1>
    <div class="version">v1.2</div>
  </header>

  <!-- Layout principal: sidebar izquierda, contenido, panel de control -->
  <div class="dashboard">
    <!-- Panel lateral: Recursos y Torres -->
    <aside class="card">
      <h2>Recursos</h2>
      <div class="resources-container">
        <div class="resource" id="leaves">🍃 Hojas: <span class="resource-value">50</span></div>
        <div class="resource" id="score">🏆 Puntuación: <span class="resource-value">0</span></div>
        <div class="resource" id="wave">🌊 Oleada: <span class="resource-value">1</span>/10</div>
      </div>
      
      <h2>Torres Disponibles</h2>
      <div class="towers-container">
        <div class="tower-option" data-type="basic" draggable="true">
          <div class="tower-icon basic-tower">🐜</div>
          <div class="tower-info">
            <div class="tower-name">Hormiga Soldado</div>
            <div class="tower-cost">Coste: 10 🍃</div>
          </div>
        </div>
        
        <div class="tower-option" data-type="shooter" draggable="true">
          <div class="tower-icon shooter-tower">🏹</div>
          <div class="tower-info">
            <div class="tower-name">Hormiga Arquera</div>
            <div class="tower-cost">Coste: 20 🍃</div>
          </div>
        </div>
        
        <div class="tower-option" data-type="bomber" draggable="true">
          <div class="tower-icon bomber-tower">💣</div>
          <div class="tower-info">
            <div class="tower-name">Hormiga Bombardera</div>
            <div class="tower-cost">Coste: 30 🍃</div>
          </div>
        </div>
      </div>
      
      <div class="button-group">
        <button id="startWaveBtn" class="action-btn">Iniciar Oleada</button>
        <button id="speedBtn" class="action-btn">Velocidad: x1</button>
      </div>
    </aside>

    <!-- Zona principal: mapa de juego -->
    <main class="card">
      <div id="gameContainer">
        <canvas id="gameCanvas" width="600" height="400"></canvas>
        <div id="gameOverlay">
          <div id="gameMessage">¡Prepárate para defender!</div>
          <button id="startGameBtn" class="action-btn">Comenzar Juego</button>
        </div>
      </div>
      
      <div class="game-controls">
        <div class="health-bar">
          <div>❤️ Salud del Hormiguero: <span id="healthValue">100</span>/100</div>
          <div class="health-bar-container">
            <div id="healthBarFill"></div>
          </div>
        </div>
      </div>
      
      <div class="log-container">
        <h3>Registro de Batalla <button id="clearLog" class="small-btn" title="Limpiar registro">🗑️</button></h3>
        <div class="log" id="battleLog"></div>
      </div>
    </main>

    <!-- Panel derecho: Información y Mejoras -->
    <aside class="card">
      <h2>Información</h2>
      <div id="towerInfo">
        <p>Selecciona una torre para ver su información</p>
      </div>
      
      <h2>Mejoras</h2>
      <div id="upgradePanel">
        <p>Selecciona una torre colocada para mejorarla</p>
      </div>
      
      <div class="button-group">
        <button id="sellTowerBtn" class="danger-btn" disabled>Vender Torre</button>
        <button id="upgradeTowerBtn" class="action-btn" disabled>Mejorar Torre</button>
      </div>
    </aside>
  </div>
  
  <!-- Modal de ayuda -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h2>Cómo jugar Tower Defense 🐜</h2>
      <div class="help-content">
        <h3>Objetivo</h3>
        <p>Defiende tu hormiguero de las oleadas de insectos enemigos construyendo torres defensivas.</p>
        
        <h3>Torres</h3>
        <ul>
          <li><strong>Hormiga Soldado (🐜)</strong>: Ataque básico de corto alcance</li>
          <li><strong>Hormiga Arquera (🏹)</strong>: Ataque a distancia</li>
          <li><strong>Hormiga Bombardera (💣)</strong>: Ataque de área</li>
        </ul>
        
        <h3>Enemigos</h3>
        <ul>
          <li><strong>Escarabajo</strong>: Enemigo básico</li>
          <li><strong>Araña</strong>: Rápido pero débil</li>
          <li><strong>Hormiga Exploradora</strong>: Muy rápida</li>
          <li><strong>Hormiga Soldado</strong>: Resistente</li>
          <li><strong>Avispa</strong>: Extremadamente rápida</li>
          <li><strong>Escarabajo Gigante</strong>: Muy resistente</li>
          <li><strong>Ciempiés</strong>: Jefe final</li>
        </ul>
        
        <h3>Cómo jugar</h3>
        <ol>
          <li>Arrastra y suelta torres en el mapa</li>
          <li>Inicia la oleada cuando estés listo</li>
          <li>Mejora tus torres para aumentar su poder</li>
          <li>Sobrevive a las 10 oleadas para ganar</li>
        </ol>
        
        <h3>Recompensas</h3>
        <p>Al completar niveles ganarás hojas que podrás usar en el juego principal.</p>
        
        <h3>Imágenes</h3>
        <p>Este juego utiliza imágenes estáticas para las torres.</p>
      </div>
    </div>
  </div>
  
  <script>
    // Funcionalidad del modal de ayuda
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('helpModal');
      const helpBtn = document.getElementById('helpBtn');
      const closeBtn = document.querySelector('.close-btn');
      const clearLogBtn = document.getElementById('clearLog');
      const backBtn = document.getElementById('backBtn');
      
      helpBtn.onclick = function() {
        modal.style.display = 'block';
      }
      
      closeBtn.onclick = function() {
        modal.style.display = 'none';
      }
      
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = 'none';
        }
      }
      
      if (clearLogBtn) {
        clearLogBtn.onclick = function() {
          const logElement = document.getElementById('battleLog');
          if (logElement) {
            logElement.innerHTML = '';
          }
        }
      }
      
      if (backBtn) {
        backBtn.onclick = function() {
          window.location.href = '/juego.html';
        }
      }
    });
  </script>
</body>
</html>